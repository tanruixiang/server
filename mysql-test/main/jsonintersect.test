# scalar(number) intersect scalar(number)
SET @json1 = '1';
SET @json2 = '1';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1 = '1';
SET @json2 = '2';
SELECT JSON_INTERSECT(@json1,@json2);

# scalar intersect scalar array
SET @json1 = '3';
SET @json2 = '[1,2,3,4,5]';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1 = '6';
SET @json2 = '[1,2,3,4,5]';
SELECT JSON_INTERSECT(@json1,@json2);

# scalar(string) intersect scalar(string)
SET @json1 = '"a"';
SET @json2 = '"a"';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1 = '"a"';
SET @json2 = '"b"';
SELECT JSON_INTERSECT(@json1,@json2);

# scalar(string) intersect scalar(string) array
SET @json1 = '"z"';
SET @json2 = '["a","b,"cd","ef","f"]';
SELECT JSON_INTERSECT(@json1,@json2);

# object intersect object
SET @json1 = '{"key1":"value1","key2":"value2"}';
SET @json2 = '{"key2":"value2","key1":"value1"}';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1 = '{"key1":"value1"}';
SET @json2 = '{"key2":"value2"}';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1 = '{"key1":{"kkey1":"vvalue1"}}';
SET @json2 = '{"key1":{"kkey1":"vvalue1"}}';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1 = '{"key1":{"kkey1":"vvalue1","kkey2","vvalue2"}}';
SET @json2 = '{"key1":{"kkey1":"vvalue1"}}';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1 = '{"key1":{"kkey1":"vvalue1","kkey2","vvalue2"}}';
SET @json2 = '{"key1":{"kkey1":"vvalue1"}}';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1 = '{"key1":[{"kkey1":"vvalue1"},{"kkey2","vvalue2"}]}';
SET @json2 = '{"key1":{"kkey1":"vvalue1"}}';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1 = '{"key1":[{"kkey1":"vvalue1"},{"kkey2":"vvalue2"}]}';
SET @json2 = '{"key1":{"kkey2":"vvalue2"}}';
SELECT JSON_INTERSECT(@json1,@json2);
SET @json1= '{"key1":"val1", "key2":"val2", "key3":{"key7":"val7"}}';
SET @json2= '{"key4":"val4", "key2":"val2", "key5":"val5", "key3":"val3", "key6":"val6"}';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '{"key1":{"key1":{"key1":"value1"}}}';
SET @json2= '{"key1":{"key1":{"key1":"value1"}}}';
SELECT JSON_INTERSECT(@json1, @json2);

# object intersect object array
SET @json1 = '{"kkey1":"vvalue1"}';
SET @json2 = '[{"kkey1":"vvalue1"},{"kkey2":"vvalue2"}]';
SELECT JSON_INTERSECT(@json1,@json2);

# object have duplicate keys
SET @json1= '{"key1":"val1", "key2":"val2", "key3":"val3"}';
SET @json2= '{"key3":"val3", "key2":"val2", "key4":"val4", "key3":"val3", "key5":"val5"}';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '{"key1":"val1", "key2":"val2", "key3":"val3"}';
SET @json2= '{"key3":"val4", "key2":"val2", "key4":"val4", "key3":"val3", "key5":"val5"}';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '{"a":"a"}';
SET @json2= '{"a":"a", "a":"a", "a":"a"}'; 
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '{"a":"a", "a":"a", "a":"a"}'; 
SET @json2= '{"a":"a"}';
SELECT JSON_INTERSECT(@json1, @json2);

# array intersect array
SET @json1= '[1,2,3]'; 
SET @json2= '[1,2,3]'; 
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '[1,2,3]'; 
SET @json2= '[1,2,4]'; 
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '[1,2,3]'; 
SET @json2= '[3,2,1]'; 
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '{"key1":[1,2,3]}'; 
SET @json2= '{"key1":[1,2,3]}'; 
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '{"key1":[1,2,3]}'; 
SET @json2= '{"key1":[1,2,4]}'; 
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '{"key1":[1,2,3]}'; 
SET @json2= '{"key1":[3,2,1]}'; 
SELECT JSON_INTERSECT(@json1, @json2);
# object array intersect object array
SET @json1 = '[{"kkey1":"vvalue1"},{"kkey2":"vvalue2"}]';
SET @json2 = '[{"kkey1":"vvalue1"},{"kkey2":"vvalue2"}]';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1 = '[{"kkey1":"vvalue1"},{"kkey3":"vvalue2"}]';
SET @json2 = '[{"kkey1":"vvalue1"},{"kkey2":"vvalue2"}]';
SELECT JSON_INTERSECT(@json1, @json2);
# object array inersect object
SET @json1 = '[{"kkey1":"vvalue1"},{"kkey2":"vvalue2"}]';
SET @json2 = '{"kkey2":"vvalue2"}';
SELECT JSON_INTERSECT(@json1, @json2);

# array intersect scalar
SET @json1 = '[1,2,3]';
SET @json2 = '3';
SELECT JSON_INTERSECT(@json1, @json2);

# deeply nested object  
SET @json1 = '{"key1":{"kkey1":{"kkkey1":{"kkkkey1":"value1"}}}}';
SET @json2 = '{"key1":{"kkey1":{"kkkey1":{"kkkkey1":"value1"}}}}';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1 = '{"key1":{"kkey1":{"kkkey1":{"kkkkey1":"value1"}}}}';
SET @json2 = '{"key1":{"kkey1":{"kkkey2":{"kkkkey1":"value1"}}}}';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1 = '{"key1":{"kkey1":{"kkkey1":{"kkkkey1":"value1"}}}}';
SET @json2 = '{"key1":{"kkey1":{"kkkey1":{"kkkkey1":"value1_not"}}}}';
SELECT JSON_INTERSECT(@json1, @json2);

# nested array 
SET @json1= '[6,6,6]';
SET @json2= '[[1,2,3],[4,5,6],[1,3,2]]';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1= '[[1,2,3],[4,5,6],[1,3,2]]';
SET @json2= '[[1,2,3],[4,5,6],[1,3,2]]';
SELECT JSON_INTERSECT(@json1, @json2);


SET @json1 = '[{"k1":"v1","k2":"v2"},{"k2":"v2"}]';
SET @json2 = '[{"kkey1":"vvalue1"},{"k2":"v2","k1":"v1"}]';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1 = '[{"k1":"v1","k2":"v2"},{"k2":"v2","k1":"v1"}]';
SET @json2 = '[{"k1":"v1","k2":"v2"},{"k1":"v1","k2":"v2"}]';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1 = '[{"k1":"v1","k2":"v2"},{"k2":"v2","k1":"v1"}]';
SET @json2 = '[{"k1":"v1","k2":"v2"},{"k1":"v1","k2":"v2"},{"k1":"v1","k2":"v2"}]';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1 = '[{"k1":"v1","k2":[1,2,3]},{"k2":"v2","k1":"v1"}]';
SET @json2 = '[{"k1":"v1","k2":"v2"},{"k1":"v1","k2":[1,2,3]},{"k1":"v1","k2":"v2"}]';
SELECT JSON_INTERSECT(@json1, @json2);
SET @json1 = '[{"k1":"v1","k2":[1,2,3]},{"k2":"v2","k1":"v1"}]';
SET @json2 = '[{"k1":"v1","k2":"v2"},{"k1":"v1","k2":[3,2,1]},{"k1":"v1","k2":"v2"}]';
SELECT JSON_INTERSECT(@json1, @json2);
